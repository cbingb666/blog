import{r as l,c as r,a as n,e as a,F as t,b as s,o}from"./app.74cb0f5c.js";import{_ as i}from"./plugin-vue_export-helper.21dcd24c.js";var c="/blog/assets/image_6.e75faaec.svg",b="/blog/assets/image_9.4b887062.png",d="/blog/assets/image_8.5005c592.png",p="/blog/assets/image_7.c5b1a28b.png",h="/blog/assets/image_0.6b44ffe4.png",u="/blog/assets/image.411600e0.png",_="/blog/assets/image_1.5189b444.png",m="/blog/assets/image_2.f65d29ec.png",g="/blog/assets/image_6.bbd5df26.png",k="/blog/assets/image_3.4d9c88b6.png",f="/blog/assets/image_4.3148d919.png",x="/blog/assets/image_5.6659a001.png";const v={},w=n("h1",{id:"\u81EA\u52A8\u5316\u90E8\u7F72",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u81EA\u52A8\u5316\u90E8\u7F72","aria-hidden":"true"},"#"),s(" \u81EA\u52A8\u5316\u90E8\u7F72")],-1),N=n("h2",{id:"\u91C7\u7528\u6280\u672F",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u91C7\u7528\u6280\u672F","aria-hidden":"true"},"#"),s(" \u91C7\u7528\u6280\u672F")],-1),E={href:"https://www.docker.com/",target:"_blank",rel:"noopener noreferrer"},M=s("Docker"),A=s(" \u5BB9\u5668\u5316\u6280\u672F"),j={href:"https://www.portainer.io/",target:"_blank",rel:"noopener noreferrer"},y=s("Portainer"),C=s(" Docker\u53EF\u89C6\u5316 (\u975E\u5FC5\u9700)"),O={href:"https://www.jenkins.io/",target:"_blank",rel:"noopener noreferrer"},I=s("Jenkins"),J=s(" \u81EA\u52A8\u5316\u6784\u5EFA\u5DE5\u5177"),D={href:"https://www.nginx.com/",target:"_blank",rel:"noopener noreferrer"},R=s("Nginx"),T=s(" \u53CD\u5411\u4EE3\u7406"),$={href:"https://docs.github.com/en/developers/webhooks-and-events/about-webhooks#:~:text=Webhooks%20allow%20you%20to%20build,to%20the%20webhook's%20configured%20URL.",target:"_blank",rel:"noopener noreferrer"},G=s("Github Webhooks"),P=s(" Github \u7F51\u7EDC\u94A9\u5B50"),B=n("h2",{id:"\u81EA\u52A8\u5316\u90E8\u7F72\u67B6\u6784\u56FE",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u81EA\u52A8\u5316\u90E8\u7F72\u67B6\u6784\u56FE","aria-hidden":"true"},"#"),s(" \u81EA\u52A8\u5316\u90E8\u7F72\u67B6\u6784\u56FE")],-1),F=n("p",null,[n("img",{src:c,alt:"\u81EA\u52A8\u5316\u90E8\u7F72\u67B6\u6784\u56FE"})],-1),L=n("h2",{id:"\u5F00\u59CB",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5F00\u59CB","aria-hidden":"true"},"#"),s(" \u5F00\u59CB")],-1),V=n("h3",{id:"\u5B89\u88C5\u4E0E\u521D\u59CB\u914D\u7F6E",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5B89\u88C5\u4E0E\u521D\u59CB\u914D\u7F6E","aria-hidden":"true"},"#"),s(" \u5B89\u88C5\u4E0E\u521D\u59CB\u914D\u7F6E")],-1),W=n("h4",{id:"\u5B89\u88C5-docker",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5B89\u88C5-docker","aria-hidden":"true"},"#"),s(" \u5B89\u88C5 Docker")],-1),Y=s("\u8BE6\u89C1"),q={href:"/notes/docker.html",target:"_blank",rel:"noopener noreferrer"},S=s("Docker"),U=n("h4",{id:"\u5B89\u88C5-jenkins",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5B89\u88C5-jenkins","aria-hidden":"true"},"#"),s(" \u5B89\u88C5 Jenkins")],-1),X=s("\u8BE6\u89C1"),z={href:"/notes/jenkins.html",target:"_blank",rel:"noopener noreferrer"},H=s("Jenkins"),K=n("h4",{id:"\u5728-jenkins-\u4E2D\u6DFB\u52A0\u5168\u5C40github-ssh",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5728-jenkins-\u4E2D\u6DFB\u52A0\u5168\u5C40github-ssh","aria-hidden":"true"},"#"),s(" \u5728 Jenkins \u4E2D\u6DFB\u52A0\u5168\u5C40github ssh")],-1),Q=n("ol",null,[n("li",null,"\u8FDB\u5165 Jenkins \u5BB9\u5668")],-1),Z=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[s("docker container "),n("span",{class:"token builtin class-name"},"exec"),s(" -it jenkins "),n("span",{class:"token function"},"bash"),s(`
`)])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),nn=n("ol",{start:"2"},[n("li",null,"\u751F\u6210ssh, \u4E00\u76F4\u56DE\u8F66\u786E\u8BA4\u5373\u53EF")],-1),sn=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,`ssh-keygen -t rsa
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br")])],-1),en=n("ol",{start:"3"},[n("li",null,"\u67E5\u770Bssh")],-1),an=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token comment"},"# \u67E5\u770B\u79C1\u94A5"),s(`
`),n("span",{class:"token function"},"cat"),s(` ~/.ssh/id_rsa
`),n("span",{class:"token comment"},"# \u67E5\u770B\u516C\u94A5"),s(`
`),n("span",{class:"token function"},"cat"),s(` ~/.ssh/id_rsa.pub
`)])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br")])],-1),ln=n("ol",{start:"4"},[n("li",null,[n("p",null,"\u6DFB\u52A0\u516C\u94A5\u5230 github")]),n("li",null,[n("p",null,"\u6DFB\u52A0\u79C1\u94A5\u5230 Jenkins Manage Credentials"),n("p",null,"\u8FDB\u5165ManageJenkins"),n("p",null,[n("img",{src:b,alt:"\u8FDB\u5165ManageJenkins"})]),n("p",null,"\u8FDB\u5165Manage Credentials"),n("p",null,[n("img",{src:d,alt:"\u8FDB\u5165Manage Credentials"})]),n("p",null,"\u6DFB\u52A0\u4E00\u6761\u51ED\u8BC1"),n("p",null,[n("img",{src:p,alt:"\u6DFB\u52A0\u4E00\u6761\u51ED\u8BC1"})])])],-1),rn=n("h3",{id:"\u9879\u76EE\u914D\u7F6E",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u9879\u76EE\u914D\u7F6E","aria-hidden":"true"},"#"),s(" \u9879\u76EE\u914D\u7F6E")],-1),tn=n("h4",{id:"\u4E3A\u9879\u76EE\u6DFB\u52A0dockerfile",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u4E3A\u9879\u76EE\u6DFB\u52A0dockerfile","aria-hidden":"true"},"#"),s(" \u4E3A\u9879\u76EE\u6DFB\u52A0Dockerfile")],-1),on=n("blockquote",null,[n("p",null,"Dockerfile \u914D\u7F6E\u5982\u4E0B")],-1),cn=n("div",{class:"language-docker ext-docker line-numbers-mode"},[n("pre",{class:"language-docker"},[n("code",null,[n("span",{class:"token comment"},"# \u4F7F\u7528nginx"),s(`
`),n("span",{class:"token instruction"},[n("span",{class:"token keyword"},"FROM"),s(" nginx")]),s(`
`),n("span",{class:"token comment"},"# \u590D\u5236 dist \u76EE\u5F55 \u5230 /usr/share/nginx/html/ \u76EE\u5F55\u4E0B"),s(`
`),n("span",{class:"token instruction"},[n("span",{class:"token keyword"},"COPY"),s(" dist/ /usr/share/nginx/html/")]),s(`
`),n("span",{class:"token comment"},"# \u590D\u5236 nginx/default.conf \u5230 /etc/nginx/conf.d/default.conf"),s(`
`),n("span",{class:"token instruction"},[n("span",{class:"token keyword"},"COPY"),s(" nginx/default.conf /etc/nginx/conf.d/default.conf")]),s(`
`),n("span",{class:"token comment"},"# \u66B4\u9732\u572880\u7AEF\u53E3"),s(`
`),n("span",{class:"token instruction"},[n("span",{class:"token keyword"},"EXPOSE"),s(" 80")]),s(`
`)])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br")])],-1),bn=n("h4",{id:"\u4E3A\u9879\u76EE\u6DFB\u52A0-nginx-default-conf",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u4E3A\u9879\u76EE\u6DFB\u52A0-nginx-default-conf","aria-hidden":"true"},"#"),s(" \u4E3A\u9879\u76EE\u6DFB\u52A0 nginx/default.conf")],-1),dn=n("div",{class:"language-conf ext-conf line-numbers-mode"},[n("pre",{class:"language-conf"},[n("code",null,`server {
    listen       80;
    server_name  localhost;

    #charset koi8-r;
    access_log  /var/log/nginx/host.access.log  main;
    error_log  /var/log/nginx/error.log  error;

    location / {
        root   /usr/share/nginx/html;
        index  index.html index.htm;
    }

    #error_page  404              /404.html;

    # redirect server error pages to the static page /50x.html
    #
    error_page   500 502 503 504  /50x.html;
    location = /50x.html {
        root   /usr/share/nginx/html;
    }
}
`)]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br"),n("span",{class:"line-number"},"11"),n("br"),n("span",{class:"line-number"},"12"),n("br"),n("span",{class:"line-number"},"13"),n("br"),n("span",{class:"line-number"},"14"),n("br"),n("span",{class:"line-number"},"15"),n("br"),n("span",{class:"line-number"},"16"),n("br"),n("span",{class:"line-number"},"17"),n("br"),n("span",{class:"line-number"},"18"),n("br"),n("span",{class:"line-number"},"19"),n("br"),n("span",{class:"line-number"},"20"),n("br"),n("span",{class:"line-number"},"21"),n("br"),n("span",{class:"line-number"},"22"),n("br")])],-1),pn=n("h4",{id:"\u5728-jenkins-\u65B0\u5EFA\u6784\u5EFA\u6D41",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#\u5728-jenkins-\u65B0\u5EFA\u6784\u5EFA\u6D41","aria-hidden":"true"},"#"),s(" \u5728 Jenkins \u65B0\u5EFA\u6784\u5EFA\u6D41")],-1),hn=n("p",null,"\u521B\u5EFA\u65B0\u9879\u76EE",-1),un=n("p",null,[n("img",{src:h,alt:"image_0"})],-1),_n=n("p",null,[s("\u586B\u5165github\u9879\u76EE\u5730\u5740 "),n("img",{src:u,alt:"image"})],-1),mn=n("p",null,[s("\u6DFB\u52A0git\u6E90\u4EE3\u7801\u7BA1\u7406 "),n("img",{src:_,alt:"image_1"})],-1),gn=n("p",null,[s("\u6DFB\u52A0\u6784\u5EFA\u89E6\u53D1\u5668 "),n("img",{src:m,alt:"image_2"})],-1),kn=n("p",null,[s("\u5728github\u4ED3\u5E93\u4E2D\u8FDB\u5165settings\u8BBE\u7F6Ewebhook "),n("img",{src:g,alt:"image_6"})],-1),fn=n("p",null,[s("\u6DFB\u52A0node\u6784\u5EFA\u73AF\u5883 "),n("img",{src:k,alt:"image_3"})],-1),xn=n("p",null,[s("\u6DFB\u52A0Execute shell\u6784\u5EFA\u6B65 "),n("img",{src:f,alt:"image_4"})],-1),vn=n("p",null,[s("\u5728Execute shell\u52A0\u5165\u4E00\u4E0B\u811A\u672C "),n("img",{src:x,alt:"image_5"})],-1),wn=n("div",{class:"language-bash ext-sh line-numbers-mode"},[n("pre",{class:"language-bash"},[n("code",null,[n("span",{class:"token shebang important"},"#!/bin/bash"),s(`
`),n("span",{class:"token assign-left variable"},"IMAGE_NAME"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"notes"'),s(`
`),n("span",{class:"token assign-left variable"},"CONTAINER_NAME"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'"notes"'),s(`
`),n("span",{class:"token assign-left variable"},"CONTAINER_ID"),n("span",{class:"token operator"},"="),n("span",{class:"token string"},'""'),s(`
`),n("span",{class:"token function"},"npm"),s(),n("span",{class:"token function"},"install"),s(" --registry"),n("span",{class:"token operator"},"="),s(`http://registry.npm.taobao.org
`),n("span",{class:"token function"},"npm"),s(` run build
`),n("span",{class:"token comment"},"# \u6253\u5305\u955C\u50CF"),s(`
docker image build ./ -t `),n("span",{class:"token variable"},"$IMAGE_NAME"),s(`:latest
`),n("span",{class:"token comment"},"# \u68C0\u67E5\u662F\u5426\u5B58\u5728\u65E7\u5BB9\u5668"),s(`
docker container inspect `),n("span",{class:"token variable"},"$CONTAINER_NAME"),s(`
`),n("span",{class:"token keyword"},"if"),s(),n("span",{class:"token punctuation"},"["),s(),n("span",{class:"token variable"},"$?"),s(),n("span",{class:"token operator"},"="),s(),n("span",{class:"token string"},'"0"'),s(),n("span",{class:"token punctuation"},"]"),n("span",{class:"token punctuation"},";"),s(),n("span",{class:"token keyword"},"then"),s(`
    `),n("span",{class:"token comment"},"# \u5220\u9664\u65E7\u5BB9\u5668"),s(`
    docker container `),n("span",{class:"token function"},"rm"),s(" -f "),n("span",{class:"token variable"},"$CONTAINER_NAME"),s(`
`),n("span",{class:"token keyword"},"fi"),s(`
`),n("span",{class:"token comment"},"# \u8FD0\u884C\u5BB9\u5668"),s(`
docker run -p `),n("span",{class:"token number"},"8845"),s(":80 -d --name "),n("span",{class:"token variable"},"$CONTAINER_NAME"),s(),n("span",{class:"token variable"},"$IMAGE_NAME"),s(`:latest
`)])]),n("div",{class:"line-numbers"},[n("span",{class:"line-number"},"1"),n("br"),n("span",{class:"line-number"},"2"),n("br"),n("span",{class:"line-number"},"3"),n("br"),n("span",{class:"line-number"},"4"),n("br"),n("span",{class:"line-number"},"5"),n("br"),n("span",{class:"line-number"},"6"),n("br"),n("span",{class:"line-number"},"7"),n("br"),n("span",{class:"line-number"},"8"),n("br"),n("span",{class:"line-number"},"9"),n("br"),n("span",{class:"line-number"},"10"),n("br"),n("span",{class:"line-number"},"11"),n("br"),n("span",{class:"line-number"},"12"),n("br"),n("span",{class:"line-number"},"13"),n("br"),n("span",{class:"line-number"},"14"),n("br"),n("span",{class:"line-number"},"15"),n("br"),n("span",{class:"line-number"},"16"),n("br")])],-1);function Nn(En,Mn){const e=l("OutboundLink");return o(),r(t,null,[w,N,n("ul",null,[n("li",null,[n("a",E,[M,a(e)]),A]),n("li",null,[n("a",j,[y,a(e)]),C]),n("li",null,[n("a",O,[I,a(e)]),J]),n("li",null,[n("a",D,[R,a(e)]),T]),n("li",null,[n("a",$,[G,a(e)]),P])]),B,F,L,V,W,n("p",null,[Y,n("a",q,[S,a(e)])]),U,n("p",null,[X,n("a",z,[H,a(e)])]),K,Q,Z,nn,sn,en,an,ln,rn,tn,on,cn,bn,dn,pn,hn,un,_n,mn,gn,kn,fn,xn,vn,wn],64)}var yn=i(v,[["render",Nn]]);export{yn as default};
